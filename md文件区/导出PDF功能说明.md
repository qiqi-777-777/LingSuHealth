# 导出PDF功能说明

## 功能概述
用户可以选择任意一条打卡记录，将其导出为精美的PDF文档，方便保存和分享。

## 使用方法

### 1. 打开导出对话框
在打卡历史页面，点击右上角的"导出"按钮

### 2. 选择要导出的记录
- 对话框会显示所有打卡记录列表
- 每条记录显示：
  - 日期（年月日 + 星期）
  - 健康分（带颜色标识）
  - 睡眠时长
  - 情绪状态
  - 运动时长
- 点击任意记录进行选择（会显示绿色选中状态）

### 3. 确认导出
- 点击"确认导出"按钮
- 系统会自动生成PDF文件
- 文件名格式：`健康打卡记录_2026-01-26.pdf`
- 自动下载到浏览器默认下载目录

## PDF内容包含

### 1. 标题页
- 文档标题："健康打卡记录"
- 打卡日期（完整格式）

### 2. 健康评分
- 大号圆形健康分显示
- 根据分数显示不同颜色：
  - 85分以上：绿色（优秀）
  - 70-84分：蓝色（良好）
  - 60-69分：橙色（一般）
  - 60分以下：红色（需改善）

### 3. 基础数据
- 睡眠时长
- 入睡时间
- 情绪状态
- 运动时长

### 4. 身体症状（如有）
- 以标签形式展示所有症状

### 5. 饮食记录（如有）
- 完整的饮食记录文本

### 6. 健康总结（如有）
- AI生成的健康分析总结

### 7. 个性化建议（如有）
- 分类展示各项建议
- 包含标题和详细内容

### 8. 明日养生方案（如有）
- AI生成的明日养生建议

### 9. 页脚
- 导出时间
- 系统标识："灵素养生健康管理系统"

## 技术实现

### 依赖库
- `html2canvas`: 将HTML内容转换为Canvas图像
- `jspdf`: 生成PDF文档

### 实现流程
1. 用户选择记录后，将记录数据填充到隐藏的PDF模板中
2. 使用 `html2canvas` 将模板渲染为高清图像（scale=2）
3. 使用 `jspdf` 创建A4大小的PDF文档
4. 将图像插入PDF并自动下载

### 样式特点
- A4纸张大小（210mm宽）
- 专业的排版布局
- 清晰的分区和标题
- 适合打印的配色方案
- 中文字体支持

## 注意事项

1. **浏览器兼容性**
   - 支持所有现代浏览器（Chrome、Firefox、Safari、Edge）
   - 需要启用JavaScript

2. **导出时间**
   - 通常需要2-5秒完成
   - 导出过程中会显示"导出中..."提示
   - 请勿关闭页面

3. **文件大小**
   - 单个PDF文件约200-500KB
   - 取决于内容多少

4. **隐私保护**
   - PDF在本地浏览器生成
   - 不会上传到服务器
   - 完全保护用户隐私

## 使用场景

1. **个人存档**
   - 保存重要的健康记录
   - 建立个人健康档案

2. **医疗咨询**
   - 就医时提供给医生参考
   - 展示健康状况变化

3. **健康分享**
   - 与家人分享健康状态
   - 向健康顾问咨询

4. **打印存档**
   - 打印纸质版保存
   - 制作健康日记本

## 故障排查

### 问题1：点击导出没有反应
**原因：** 未选择记录
**解决：** 先点击选择一条记录，再点击"确认导出"

### 问题2：导出失败提示
**原因：** 浏览器阻止了下载
**解决：** 
1. 检查浏览器下载设置
2. 允许网站下载文件
3. 清除浏览器缓存后重试

### 问题3：PDF内容不完整
**原因：** 网络加载问题或数据缺失
**解决：**
1. 刷新页面重新加载数据
2. 检查网络连接
3. 重新打卡生成完整数据

### 问题4：中文显示乱码
**原因：** 字体加载问题
**解决：**
1. 使用最新版浏览器
2. 确保系统安装了中文字体
3. 刷新页面重试

## 未来优化方向

1. **批量导出**
   - 支持选择多条记录
   - 生成合并的PDF报告

2. **自定义模板**
   - 提供多种PDF模板样式
   - 用户可自定义导出内容

3. **图表导出**
   - 在PDF中包含健康趋势图
   - 可视化展示数据变化

4. **云端存储**
   - 可选择保存到云端
   - 随时随地访问历史PDF

5. **分享功能**
   - 生成分享链接
   - 直接发送给医生或家人
